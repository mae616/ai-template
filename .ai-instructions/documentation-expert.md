# ドキュメント専門家指示
> 基本設定: @core-personality.md + @development-core.md
> 専門領域: ドキュメント作成、UML設計、設計文書

# リバースエンジニアリング文書化
TDDとアジャイル開発で作成・修正したコードは、以下のディレクトリに適切なマークダウンを作成・更新：

- **`doc/rdd.md`**: 要件の変更や追加
- **`doc/architecture.md`**: アーキテクチャの設計や変更
- **`doc/api-specification.md`**: API設計の追加や変更
- **`doc/design_document/`**: 設計ドキュメントの作成・更新

## UML設計文書作成
システム全体を俯瞰するためのUML図をアスキーアート形式で作成し、`doc/uml/` に保存：

### 作成すべきUML図
- **クラス図** (`class-diagram.md`): 主要コンポーネント・関数・データモデルの関係
- **ページ遷移図** (`page-flow-diagram.md`): ユーザーの画面遷移フロー
- **システム構成図** (`system-overview.md`): 全体アーキテクチャの俯瞰
- **データフロー図** (`data-flow.md`): 情報の流れと変換プロセス

### UML作成指針
- **実装ベース**: 実際のコードベースからリバースエンジニアリング
- **日本語表記**: クラス名・関数名は実装に合わせて適切に表記
- **関係性重視**: 継承、依存、集約などの関係を明確に表現
- **段階的詳細化**: 全体像から詳細へ、レイヤー別に整理

## デザインドキュメントの作成
`doc/design_document/` にシステムの設計ドキュメントを作成。
デザインドキュメントはGoogleデザインドキュメントベストプラクティスに従い、以下の構造で作成：

### 1. Context and Scope (背景と範囲)
- 新システムの概要と背景
- 客観的な事実のみを記載
- 簡潔で要点を絞った内容

### 2. Goals and Non-Goals (目標と非目標)
- システムの目標を箇条書きで明記
- **非目標**: 合理的に目標となりうるが、明示的に除外する項目
- 例: "ACID準拠" → データベース設計で重要な判断基準

### 3. The Actual Design (実際の設計)
- **概要から詳細へ** の順で記述
- **トレードオフ** に焦点を当てる
- 以下の要素を含む：
  - **システムコンテキスト図**: システムと環境の関係
  - **API設計**: 重要な部分のみ（完全な定義は避ける）
  - **処理フロー図**: バグ時の内容把握のため、主要な処理の流れを図解
  - **データフロー**: データがどのように流れ、変換されるかの詳細
  - **データストレージ**: 設計に関連する部分のみ
  - **制約の度合い**: グリーンフィールドから制約の多いシステムまで

### 4. Alternatives Considered (検討した代替案)
- 他の設計選択肢とそのトレードオフ
- なぜ選択した設計が最適かの説明
- 読者が疑問に思う他の解決策の検討

### 5. Cross-cutting Concerns (横断的関心事)
- セキュリティ、プライバシー、観測可能性
- 組織で標準化された関心事項
- 各関心事への対応方法

### 文書の長さ
- 100-500行程度を目安

# ドキュメント重複排除・整合性管理
## 重複排除の基本原則
- **Single Source of Truth (SSOT)**: 同一情報は1箇所のみに記載
- **適切な配置**: 各情報を最も適切なドキュメントに配置
- **相互参照**: 重複を避けて相互リンクで情報を繋ぐ
- **定期的な整合性チェック**: ドキュメント間の不整合を防ぐ

## 適切な情報配置
- **要件定義** → 機能要求・非機能要求・制約事項
- **アーキテクチャ** → システム全体の構成概要・技術選定理由
- **API設計** → エンドポイント仕様・リクエスト/レスポンス詳細
- **UML** → クラス図・データフロー・システム関係図
- **設計文書** → 実装判断・トレードオフ・技術的詳細
- **テストケース** → TDD実践・テスト戦略・具体的テストシナリオ

## 整合性チェックポイント
- **技術選定**: アーキテクチャ文書と実装詳細の一致
- **API仕様**: 設計文書と実装コードの一致
- **データモデル**: UMLクラス図と実装の一致
- **テスト内容**: テストケースと実装の一致
- **バージョン情報**: 技術スタック・依存関係の統一
